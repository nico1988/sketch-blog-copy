{"pageProps":{"post":{"fileName":"2019-12-19_JavaScript中的GC.md","id":"2019-12-19_JavaScript中的GC","permalink":"20191219185206","tags":["js"],"title":"JavaScript中的GC","date":"2019-12-19T18:52:06+08:00","categories":["笔记"],"cover":"https://cloud.miiiku.xyz/src/images/cover/cover-06.jpg","contentHtml":"<pre class=\"hljs language-js\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> f = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">let</span> v = <span class=\"hljs-string\">&quot;string&quot;</span>;\n\n  <span class=\"hljs-keyword\">let</span> c = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) {\n    v = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&quot;div&quot;</span>);\n  }\n\n  <span class=\"hljs-keyword\">let</span> p = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(v);\n  }\n\n  <span class=\"hljs-keyword\">return</span> { c, p }\n}\n\n<span class=\"hljs-title function_\">f</span>().<span class=\"hljs-title function_\">c</span>();\n\n<span class=\"hljs-title function_\">f</span>().<span class=\"hljs-title function_\">p</span>(); <span class=\"hljs-comment\">// string</span>\n</code></pre>\n<p>在调用<code>f().c()</code>以后，f没有被其他资源，被立即释放，即<code>f().c()</code>以后被GC;</p>\n<p>如何才能不被自动GC:</p>\n<pre class=\"hljs language-js\"><code class=\"language-js\"><span class=\"hljs-keyword\">let</span> o = <span class=\"hljs-title function_\">f</span>();\n\no.<span class=\"hljs-title function_\">p</span>(); <span class=\"hljs-comment\">// string</span>\n\no.<span class=\"hljs-title function_\">c</span>();\n\no.<span class=\"hljs-title function_\">p</span>(); <span class=\"hljs-comment\">// &lt;div&gt;&lt;/div&gt;</span>\n</code></pre>\n<p>如何手动释放:</p>\n<pre class=\"hljs language-js\"><code class=\"language-js\">o = <span class=\"hljs-literal\">null</span>;\n\no = <span class=\"hljs-title function_\">f</span>();\n\no.<span class=\"hljs-title function_\">p</span>(); <span class=\"hljs-comment\">// string</span>\n</code></pre>\n"}},"__N_SSG":true}